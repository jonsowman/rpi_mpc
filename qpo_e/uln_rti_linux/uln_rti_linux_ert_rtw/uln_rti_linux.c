/*
 * File: uln_rti_linux.c
 *
 * Code generated for Simulink model 'uln_rti_linux'.
 *
 * Model version                  : 1.207
 * Simulink Coder version         : 8.7 (R2014b) 08-Sep-2014
 * C/C++ source code generated on : Tue Apr 04 15:24:46 2017
 *
 * Target selection: ert.tlc
 * Embedded hardware selection: 32-bit Generic
 * Code generation objectives: Unspecified
 * Validation result: Not run
 */

#include "uln_rti_linux.h"
#include "uln_rti_linux_private.h"

/* Named constants for MATLAB Function: '<Root>/RTI_prepare' */
#define uln_rti_linux_sz               (5.0)

/* Block signals (auto storage) */
B_uln_rti_linux_T uln_rti_linux_B;

/* Block states (auto storage) */
DW_uln_rti_linux_T uln_rti_linux_DW;

/* External inputs (root inport signals with auto storage) */
ExtU_uln_rti_linux_T uln_rti_linux_U;

/* External outputs (root outports fed by signals with auto storage) */
ExtY_uln_rti_linux_T uln_rti_linux_Y;

/* Real-time model */
RT_MODEL_uln_rti_linux_T uln_rti_linux_M_;
RT_MODEL_uln_rti_linux_T *const uln_rti_linux_M = &uln_rti_linux_M_;

/* Forward declaration for local functions */
static void uln_rti_linux_multiply_LtDL(const real_T L[3600], const real_T D
  [14400], real_T Ac[900], real_T LtD[3600]);
static void uln_rti_linux_JFz_mfcn(const real_T in1[4], const real_T in3[7],
  const real_T in4[12], real_T h1, real_T JFz[60]);
static void uln_rti_linux_mldivide_j(const real_T A[144], real_T B[60]);
static void uln_rti_linux_JFk_mfcn(const real_T in1[4], const real_T in3[7],
  const real_T in4[12], real_T h1, real_T JFk[144]);
static void uln_rti_linux_F_mfcn(const real_T in1[4], real_T u1, const real_T
  in3[7], const real_T in4[12], real_T h1, real_T F[12]);
static void uln_rti_linux_mldivide(const real_T A[144], real_T B[12]);

/* Function for MATLAB Function: '<Root>/RTI_prepare' */
static void uln_rti_linux_multiply_LtDL(const real_T L[3600], const real_T D
  [14400], real_T Ac[900], real_T LtD[3600])
{
  int32_T k;
  int32_T i;
  int32_T c_j;
  int32_T c;
  int32_T b_k;

  /* UNTITLED Summary of this function goes here */
  /*    Detailed explanation goes here */
  memset(&Ac[0], 0, 900U * sizeof(real_T));
  memset(&LtD[0], 0, 3600U * sizeof(real_T));
  for (i = 0; i < 30; i++) {
    c_j = i * (int32_T)4.0;
    for (c = 0; c <= 119 - c_j; c++) {
      b_k = c_j + c;
      LtD[i + 30 * b_k] = L[120 * i + b_k] * D[120 * b_k + b_k];
    }
  }

  for (i = 0; i < 30; i++) {
    for (c_j = 0; c_j < 30; c_j++) {
      c = c_j * (int32_T)4.0;
      for (b_k = 0; b_k <= 119 - c; b_k++) {
        k = c + b_k;
        Ac[i + 30 * c_j] += LtD[30 * k + i] * L[120 * c_j + k];
      }
    }
  }
}

/* Function for MATLAB Function: '<Root>/RTI_prepare' */
static void uln_rti_linux_JFz_mfcn(const real_T in1[4], const real_T in3[7],
  const real_T in4[12], real_T h1, real_T JFz[60])
{
  real_T t2;
  real_T t5;
  real_T t7;
  real_T t9;
  real_T t14;
  real_T t17;
  real_T t19;
  real_T t21;
  real_T t24;
  real_T t28;
  real_T t29;
  real_T t34;
  real_T t35;
  real_T t37;
  real_T t38;
  real_T t39;
  real_T t40;
  real_T t41;
  real_T t43;
  real_T t44;
  real_T t45;
  real_T t46;
  real_T t47;
  real_T t50;
  real_T t54;
  real_T t57;
  real_T t65;
  real_T t66;
  real_T t68;
  real_T t69;
  real_T t70;
  real_T t71;
  real_T t75;
  real_T t79;
  real_T t83;
  real_T t91;
  real_T t92;
  real_T t93;
  real_T t94;
  real_T t95;
  real_T t96;
  real_T x[60];

  /* JFZ_MFCN */
  /*     JFZ = JFZ_MFCN(IN1,U1,IN3,IN4,H1) */
  /*     This function was generated by the Symbolic Math Toolbox version 6.1. */
  /*     04-Apr-2017 15:23:29 */
  t2 = 1.0 / in3[3];
  t5 = ((h1 * in4[3] * 0.19681547722366041 + h1 * in4[11] * 0.023770974348220151)
        - h1 * in4[7] * 0.065535425850198378) + in1[3];
  t7 = exp(-(t2 * 3489.7713598074611) + 7.3779521348994939);
  t9 = exp(-(t2 * 9626.9554753309258) + 20.352971406619289);
  t14 = ((h1 * in4[0] * 0.19681547722366041 + h1 * in4[8] * 0.023770974348220151)
         - h1 * in4[4] * 0.065535425850198378) + in1[0];
  t17 = ((h1 * in4[1] * 0.19681547722366041 + h1 * in4[9] * 0.023770974348220151)
         - h1 * in4[5] * 0.065535425850198378) + in1[1];
  t19 = exp(-(t2 * 6016.8471720818288) + 12.720607129137059);
  t21 = sqrt(in3[2]);
  t24 = 1.0 / in3[6];
  t28 = 1.0 / (in3[3] * 13.0 - 20000.0) * (in3[3] * t7) * 0.12465;
  t29 = in1[3] * 6016.8471720818288;
  t34 = exp(((((h1 * in4[3] * 1184.2086475551171 + t29) + h1 * in4[11] *
               143.02631978471811) - h1 * in4[7] * 394.31664169794448) -
             12033.694344163659) * t2);
  t35 = t7 * t21 * 0.015;
  t37 = 1.0 / in3[5];
  t38 = in1[3] * 4000.0;
  t39 = h1 * in4[3] * 787.26190889464181;
  t40 = h1 * in4[11] * 95.0838973928806;
  t41 = in1[2] * 4000.0;
  t43 = t34 * 2.0E+9;
  t44 = h1 * in4[2] * 787.26190889464181;
  t45 = h1 * in4[10] * 95.0838973928806;
  t46 = t2 * t5 * t34 * 1.203369434416366E+13;
  t47 = in3[4] * t24;
  t50 = ((h1 * in4[3] * 0.39442431473908729 + h1 * in4[7] * 0.29207341166522838)
         - h1 * in4[11] * 0.041548752125997922) + in1[3];
  t54 = ((h1 * in4[0] * 0.39442431473908729 + h1 * in4[4] * 0.29207341166522838)
         - h1 * in4[8] * 0.041548752125997922) + in1[0];
  t57 = ((h1 * in4[1] * 0.39442431473908729 + h1 * in4[5] * 0.29207341166522838)
         - h1 * in4[9] * 0.041548752125997922) + in1[1];
  t34 = exp(((((h1 * in4[3] * 2373.1908227381909 + t29) + h1 * in4[7] *
               1757.361081018222) - h1 * in4[11] * 249.99249173283951) -
             12033.694344163659) * t2);
  t65 = h1 * in4[3] * 1577.6972589563491;
  t66 = h1 * in4[7] * 1168.293646660914;
  t68 = t34 * 2.0E+9;
  t69 = h1 * in4[2] * 1577.6972589563491;
  t70 = h1 * in4[6] * 1168.293646660914;
  t71 = t2 * t50 * t34 * 1.203369434416366E+13;
  t75 = ((h1 * in4[3] * 0.37640306270046731 + h1 * in4[7] * 0.51248582618842164)
         + h1 * in4[11] * 0.1111111111111111) + in1[3];
  t79 = ((h1 * in4[0] * 0.37640306270046731 + h1 * in4[4] * 0.51248582618842164)
         + h1 * in4[8] * 0.1111111111111111) + in1[0];
  t83 = ((h1 * in4[1] * 0.37640306270046731 + h1 * in4[5] * 0.51248582618842164)
         + h1 * in4[9] * 0.1111111111111111) + in1[1];
  t34 = exp(((((h1 * in4[3] * 2264.7597033722459 + t29) + h1 * in4[7] *
               3083.5488940338241) + h1 * in4[11] * 668.53857467575881) -
             12033.694344163659) * t2);
  t29 = h1 * in4[3] * 1505.6122508018691;
  t91 = h1 * in4[7] * 2049.9433047536868;
  t92 = h1 * in4[11] * 444.4444444444444;
  t93 = t34 * 2.0E+9;
  t94 = h1 * in4[2] * 1505.6122508018691;
  t95 = h1 * in4[6] * 2049.9433047536868;
  t96 = h1 * in4[10] * 444.4444444444444;
  t34 = t2 * t75 * t34 * 1.203369434416366E+13;
  x[0] = ((-in3[4] * t24 - t7 * t21 * 0.015) - in3[2] * in3[5] * in3[6] * t5 *
          t19 * 550.0) - in3[5] * in3[6] * t5 * t9 * t17 * 5.0E+8;
  x[1] = t35 - in3[5] * in3[6] * t5 * t9 * t17 * 5.0E+8;
  x[2] = 0.0;
  x[3] = ((in3[2] * in3[5] * in3[6] * t5 * t19 * 550.0 + t35) + in3[5] * in3[6] *
          t5 * t9 * t17 * 1.0E+9) * (-in3[6] * t37);
  x[4] = ((-t35 - t47) - in3[2] * in3[5] * in3[6] * t19 * t50 * 550.0) - in3[5] *
    in3[6] * t9 * t50 * t57 * 5.0E+8;
  x[5] = t35 - in3[5] * in3[6] * t9 * t50 * t57 * 5.0E+8;
  x[6] = 0.0;
  x[7] = ((in3[2] * in3[5] * in3[6] * t19 * t50 * 550.0 + t35) + in3[5] * in3[6]
          * t9 * t50 * t57 * 1.0E+9) * (-in3[6] * t37);
  x[8] = ((-t35 - t47) - in3[2] * in3[5] * in3[6] * t19 * t75 * 550.0) - in3[5] *
    in3[6] * t9 * t75 * t83 * 5.0E+8;
  x[9] = t35 - in3[5] * in3[6] * t9 * t75 * t83 * 5.0E+8;
  x[10] = 0.0;
  x[11] = ((in3[2] * in3[5] * in3[6] * t19 * t75 * 550.0 + t35) + in3[5] * in3[6]
           * t9 * t75 * t83 * 1.0E+9) * (-in3[6] * t37);
  x[12] = t28 - in3[5] * in3[6] * t5 * t9 * t14 * 5.0E+8;
  x[13] = (-t28 - in3[4] * t24) - in3[5] * in3[6] * t5 * t9 * t14 * 5.0E+8;
  x[14] = 0.0;
  x[15] = (t28 - in3[5] * in3[6] * t5 * t9 * t14 * 1.0E+9) * (in3[6] * t37);
  x[16] = t28 - in3[5] * in3[6] * t9 * t50 * t54 * 5.0E+8;
  x[17] = (-t28 - t47) - in3[5] * in3[6] * t9 * t50 * t54 * 5.0E+8;
  x[18] = 0.0;
  x[19] = (t28 - in3[5] * in3[6] * t9 * t50 * t54 * 1.0E+9) * (in3[6] * t37);
  x[20] = t28 - in3[5] * in3[6] * t9 * t75 * t79 * 5.0E+8;
  x[21] = (-t28 - t47) - in3[5] * in3[6] * t9 * t75 * t79 * 5.0E+8;
  x[22] = 0.0;
  x[23] = (t28 - in3[5] * in3[6] * t9 * t75 * t79 * 1.0E+9) * (in3[6] * t37);
  x[24] = 0.0;
  x[25] = 0.0;
  x[26] = ((((t38 + t39) + t40) - h1 * in4[7] * 262.14170340079352) - in3[4] *
           t24) - 4000.0;
  x[27] = ((((t38 + t39) + t40) - h1 * in4[7] * 262.14170340079352) - 4000.0) *
    (-in3[6] * t37);
  x[28] = 0.0;
  x[29] = 0.0;
  x[30] = ((((t38 - t47) + t65) + t66) - h1 * in4[11] * 166.19500850399169) -
    4000.0;
  x[31] = ((((t38 + t65) + t66) - h1 * in4[11] * 166.19500850399169) - 4000.0) *
    (-in3[6] * t37);
  x[32] = 0.0;
  x[33] = 0.0;
  x[34] = ((((t38 - t47) + t29) + t91) + t92) - 4000.0;
  x[35] = ((((t38 + t29) + t91) + t92) - 4000.0) * (-in3[6] * t37);
  x[36] = in3[2] * in3[5] * in3[6] * t14 * t19 * -550.0 - in3[5] * in3[6] * t9 *
    t14 * t17 * 5.0E+8;
  x[37] = in3[5] * in3[6] * t9 * t14 * t17 * -5.0E+8;
  x[38] = ((((t41 + t43) + t44) + t45) + t46) - h1 * in4[6] * 262.14170340079352;
  x[39] = (((((((t41 + t43) + t44) + t45) + t46) - h1 * in4[6] *
             262.14170340079352) + in3[2] * in3[5] * in3[6] * t14 * t19 * 550.0)
           + in3[5] * in3[6] * t9 * t14 * t17 * 1.0E+9) * (-in3[6] * t37);
  x[40] = in3[2] * in3[5] * in3[6] * t19 * t54 * -550.0 - in3[5] * in3[6] * t9 *
    t54 * t57 * 5.0E+8;
  x[41] = in3[5] * in3[6] * t9 * t54 * t57 * -5.0E+8;
  x[42] = ((((t41 + t68) + t69) + t70) + t71) - h1 * in4[10] *
    166.19500850399169;
  x[43] = (((((((t41 + t68) + t69) + t70) + t71) - h1 * in4[10] *
             166.19500850399169) + in3[2] * in3[5] * in3[6] * t19 * t54 * 550.0)
           + in3[5] * in3[6] * t9 * t54 * t57 * 1.0E+9) * (-in3[6] * t37);
  x[44] = in3[2] * in3[5] * in3[6] * t19 * t79 * -550.0 - in3[5] * in3[6] * t9 *
    t79 * t83 * 5.0E+8;
  x[45] = in3[5] * in3[6] * t9 * t79 * t83 * -5.0E+8;
  x[46] = ((((t41 + t93) + t94) + t95) + t96) + t34;
  x[47] = (((((((t41 + t93) + t94) + t95) + t96) + t34) + in3[2] * in3[5] * in3
            [6] * t19 * t79 * 550.0) + in3[5] * in3[6] * t9 * t79 * t83 * 1.0E+9)
    * (-in3[6] * t37);
  x[48] = 0.0;
  x[49] = 0.0;
  x[50] = t47;
  x[51] = 0.0;
  x[52] = 0.0;
  x[53] = 0.0;
  x[54] = t47;
  x[55] = 0.0;
  x[56] = 0.0;
  x[57] = 0.0;
  x[58] = t47;
  x[59] = 0.0;
  memcpy(&JFz[0], &x[0], 60U * sizeof(real_T));
}

/* Function for MATLAB Function: '<Root>/RTI_prepare' */
static void uln_rti_linux_mldivide_j(const real_T A[144], real_T B[60])
{
  real_T temp;
  real_T b_A[144];
  int8_T ipiv[12];
  int32_T j;
  int32_T c;
  int32_T ix;
  real_T s;
  int32_T jy;
  int32_T c_ix;
  int32_T ijA;
  int32_T b_jBcol;
  int32_T b_kAcol;
  memcpy(&b_A[0], &A[0], 144U * sizeof(real_T));
  for (j = 0; j < 12; j++) {
    ipiv[j] = (int8_T)(1 + j);
  }

  for (j = 0; j < 11; j++) {
    c = j * 13;
    jy = 0;
    ix = c;
    temp = fabs(b_A[c]);
    for (b_jBcol = 2; b_jBcol <= 12 - j; b_jBcol++) {
      ix++;
      s = fabs(b_A[ix]);
      if (s > temp) {
        jy = b_jBcol - 1;
        temp = s;
      }
    }

    if (b_A[c + jy] != 0.0) {
      if (jy != 0) {
        ipiv[j] = (int8_T)((j + jy) + 1);
        b_kAcol = j;
        b_jBcol = j + jy;
        for (jy = 0; jy < 12; jy++) {
          temp = b_A[b_kAcol];
          b_A[b_kAcol] = b_A[b_jBcol];
          b_A[b_jBcol] = temp;
          b_kAcol += 12;
          b_jBcol += 12;
        }
      }

      ix = (c - j) + 12;
      for (b_jBcol = c + 1; b_jBcol + 1 <= ix; b_jBcol++) {
        b_A[b_jBcol] /= b_A[c];
      }
    }

    b_jBcol = c;
    jy = c + 12;
    for (b_kAcol = 1; b_kAcol <= 11 - j; b_kAcol++) {
      temp = b_A[jy];
      if (b_A[jy] != 0.0) {
        c_ix = c + 1;
        ix = (b_jBcol - j) + 24;
        for (ijA = 13 + b_jBcol; ijA + 1 <= ix; ijA++) {
          b_A[ijA] += b_A[c_ix] * -temp;
          c_ix++;
        }
      }

      jy += 12;
      b_jBcol += 12;
    }
  }

  for (ix = 0; ix < 11; ix++) {
    if (ix + 1 != ipiv[ix]) {
      b_jBcol = ipiv[ix] - 1;
      for (jy = 0; jy < 5; jy++) {
        temp = B[12 * jy + ix];
        B[ix + 12 * jy] = B[12 * jy + b_jBcol];
        B[b_jBcol + 12 * jy] = temp;
      }
    }
  }

  for (ix = 0; ix < 5; ix++) {
    b_jBcol = 12 * ix;
    for (jy = 0; jy < 12; jy++) {
      b_kAcol = 12 * jy;
      if (B[jy + b_jBcol] != 0.0) {
        for (c_ix = jy + 1; c_ix + 1 < 13; c_ix++) {
          B[c_ix + b_jBcol] -= B[jy + b_jBcol] * b_A[c_ix + b_kAcol];
        }
      }
    }
  }

  for (ix = 0; ix < 5; ix++) {
    b_jBcol = 12 * ix;
    for (jy = 11; jy >= 0; jy += -1) {
      b_kAcol = 12 * jy;
      if (B[jy + b_jBcol] != 0.0) {
        B[jy + b_jBcol] /= b_A[jy + b_kAcol];
        for (c_ix = 0; c_ix + 1 <= jy; c_ix++) {
          B[c_ix + b_jBcol] -= B[jy + b_jBcol] * b_A[c_ix + b_kAcol];
        }
      }
    }
  }
}

/* Function for MATLAB Function: '<Root>/RTI_prepare' */
static void uln_rti_linux_JFk_mfcn(const real_T in1[4], const real_T in3[7],
  const real_T in4[12], real_T h1, real_T JFk[144])
{
  real_T t2;
  real_T t3;
  real_T t4;
  real_T t10;
  real_T t5;
  real_T t7;
  real_T t9;
  real_T t12;
  real_T t15;
  real_T t20;
  real_T t21;
  real_T t22;
  real_T t28;
  real_T t29;
  real_T t30;
  real_T t31;
  real_T t32;
  real_T t33;
  real_T t34;
  real_T t35;
  real_T t36;
  real_T t41;
  real_T t42;
  real_T t46;
  real_T t48;
  real_T t49;
  real_T t50;
  real_T t51;
  real_T t52;
  real_T t53;
  real_T t54;
  real_T t55;
  real_T t56;
  real_T t57;
  real_T t58;
  real_T t59;
  real_T t62;
  real_T t66;
  real_T t70;
  real_T t72;
  real_T t73;
  real_T t74;
  real_T t75;
  real_T t76;
  real_T t77;
  real_T t78;
  real_T t83;
  real_T t84;
  real_T t88;
  real_T t90;
  real_T t91;
  real_T t92;
  real_T t93;
  real_T t94;
  real_T t95;
  real_T t96;
  real_T t97;
  real_T t98;
  real_T t99;
  real_T t100;
  real_T t104;
  real_T t108;
  real_T t112;
  real_T t113;
  real_T t114;
  real_T t115;
  real_T t121;
  real_T t128;
  real_T t129;
  real_T t130;
  real_T t131;
  real_T t132;
  real_T t133;
  real_T t134;
  real_T t135;
  real_T t136;
  real_T x[144];

  /* JFK_MFCN */
  /*     JFK = JFK_MFCN(IN1,U1,IN3,IN4,H1) */
  /*     This function was generated by the Symbolic Math Toolbox version 6.1. */
  /*     04-Apr-2017 15:23:26 */
  t2 = 1.0 / in3[3];
  t3 = h1 * in4[3] * 0.19681547722366041;
  t4 = h1 * in4[11] * 0.023770974348220151;
  t10 = h1 * in4[7] * 0.065535425850198378;
  t5 = ((t3 + t4) - t10) + in1[3];
  t7 = exp(-(t2 * 3489.7713598074611) + 7.3779521348994939);
  t9 = exp(-(t2 * 9626.9554753309258) + 20.352971406619289);
  t12 = exp(-(t2 * 6016.8471720818288) + 12.720607129137059);
  t15 = ((h1 * in4[0] * 0.19681547722366041 + h1 * in4[8] * 0.023770974348220151)
         - h1 * in4[4] * 0.065535425850198378) + in1[0];
  t20 = ((h1 * in4[1] * 0.19681547722366041 + h1 * in4[9] * 0.023770974348220151)
         - h1 * in4[5] * 0.065535425850198378) + in1[1];
  t21 = 1.0 / in3[6];
  t22 = sqrt(in3[2]);
  t28 = 1.0 / (in3[3] * 13.0 - 20000.0);
  t29 = h1 * in3[3] * t7 * t28 * 0.02453304923592927;
  t30 = h1 * t7 * t22 * 0.00098303138775297566;
  t31 = h1 * in3[5] * in3[6] * t5 * t9 * t20 * 3.276771292509919E+7;
  t32 = h1 * in3[4] * t21 * 0.065535425850198378;
  t33 = h1 * in3[5] * in3[6] * t5 * t9 * t15 * 3.276771292509919E+7;
  t34 = h1 * in3[5] * in3[6] * t9 * t15 * t20 * 3.276771292509919E+7;
  t35 = h1 * in3[3] * t7 * t28 * 0.002963051952505642;
  t36 = in1[3] * 6016.8471720818288;
  t41 = exp(((((h1 * in4[3] * 1184.2086475551171 + t36) + h1 * in4[11] *
               143.02631978471811) - h1 * in4[7] * 394.31664169794448) -
             12033.694344163659) * t2);
  t42 = (((t3 + t4) - t10) + in1[3]) - 1.0;
  t46 = ((h1 * in4[2] * 0.19681547722366041 + h1 * in4[10] *
          0.023770974348220151) - h1 * in4[6] * 0.065535425850198378) + in1[2];
  t48 = h1 * t7 * t22 * 0.0029522321583549068;
  t49 = 1.0 / in3[5];
  t50 = h1 * t41 * 3.9363095444732088E+8;
  t51 = h1 * t46 * 787.26190889464181;
  t52 = h1 * t2 * t5 * t41 * 2.3684172951102339E+12;
  t53 = h1 * in3[2] * in3[5] * in3[6] * t5 * t12 * 36.04448421760911;
  t54 = h1 * in3[3] * t7 * t28 * 0.0081689908322272273;
  t55 = h1 * in3[2] * in3[5] * in3[6] * t12 * t15 * 36.04448421760911;
  t56 = h1 * t7 * t22 * 0.00035656461522330229;
  t57 = h1 * t41 * 4.75419486964403E+7;
  t58 = h1 * t46 * 95.0838973928806;
  t59 = h1 * t2 * t5 * t41 * 2.8605263956943622E+11;
  t3 = h1 * in4[3] * 0.39442431473908729;
  t4 = h1 * in4[7] * 0.29207341166522838;
  t10 = h1 * in4[11] * 0.041548752125997922;
  t62 = ((t3 + t4) - t10) + in1[3];
  t66 = ((h1 * in4[0] * 0.39442431473908729 + h1 * in4[4] * 0.29207341166522838)
         - h1 * in4[8] * 0.041548752125997922) + in1[0];
  t70 = ((h1 * in4[1] * 0.39442431473908729 + h1 * in4[5] * 0.29207341166522838)
         - h1 * in4[9] * 0.041548752125997922) + in1[1];
  t72 = h1 * in3[3] * t7 * t28 * 0.04916499083222723;
  t73 = h1 * in3[3] * t7 * t28 * 0.036406950764070717;
  t74 = h1 * t7 * t22 * 0.00062323128188996875;
  t75 = h1 * in3[5] * in3[6] * t9 * t62 * t70 * 2.0774376062998962E+7;
  t76 = h1 * in3[4] * t21 * 0.041548752125997922;
  t77 = h1 * in3[5] * in3[6] * t9 * t62 * t66 * 2.0774376062998962E+7;
  t78 = h1 * in3[5] * in3[6] * t9 * t66 * t70 * 2.0774376062998962E+7;
  t83 = exp(((((h1 * in4[3] * 2373.1908227381909 + t36) + h1 * in4[7] *
               1757.361081018222) - h1 * in4[11] * 249.99249173283951) -
             12033.694344163659) * t2);
  t84 = (((t3 + t4) - t10) + in1[3]) - 1.0;
  t88 = ((h1 * in4[2] * 0.39442431473908729 + h1 * in4[6] * 0.29207341166522838)
         - h1 * in4[10] * 0.041548752125997922) + in1[2];
  t90 = h1 * t7 * t22 * 0.0059163647210863091;
  t91 = h1 * t83 * 7.8884862947817457E+8;
  t92 = h1 * t88 * 1577.6972589563491;
  t93 = h1 * t2 * t62 * t83 * 4.7463816454763809E+12;
  t94 = h1 * t7 * t22 * 0.0043811011749784259;
  t95 = h1 * t83 * 5.8414682333045685E+8;
  t96 = h1 * t88 * 1168.293646660914;
  t97 = h1 * t2 * t62 * t83 * 3.5147221620364429E+12;
  t98 = h1 * in3[2] * in3[5] * in3[6] * t12 * t62 * 22.85181366929886;
  t99 = h1 * in3[3] * t7 * t28 * 0.0051790519525056408;
  t100 = h1 * in3[2] * in3[5] * in3[6] * t12 * t66 * 22.85181366929886;
  t3 = h1 * in4[3] * 0.37640306270046731;
  t4 = h1 * in4[7] * 0.51248582618842164;
  t10 = h1 * in4[11] * 0.1111111111111111;
  t104 = ((t3 + t4) + t10) + in1[3];
  t108 = ((h1 * in4[0] * 0.37640306270046731 + h1 * in4[4] * 0.51248582618842164)
          + h1 * in4[8] * 0.1111111111111111) + in1[0];
  t112 = ((h1 * in4[1] * 0.37640306270046731 + h1 * in4[5] * 0.51248582618842164)
          + h1 * in4[9] * 0.1111111111111111) + in1[1];
  t113 = h1 * in3[3] * t7 * t28 * 0.046918641765613243;
  t114 = h1 * in3[3] * t7 * t28 * 0.063881358234386759;
  t115 = h1 * in3[3] * t7 * t28 * 0.01385;
  t121 = exp(((((h1 * in4[3] * 2264.7597033722459 + t36) + h1 * in4[7] *
                3083.5488940338241) + h1 * in4[11] * 668.53857467575881) -
              12033.694344163659) * t2);
  t10 = (((t3 + t4) + t10) + in1[3]) - 1.0;
  t3 = ((h1 * in4[2] * 0.37640306270046731 + h1 * in4[6] * 0.51248582618842164)
        + h1 * in4[10] * 0.1111111111111111) + in1[2];
  t36 = h1 * t7 * t22 * 0.0056460459405070088;
  t128 = h1 * t121 * 7.5280612540093446E+8;
  t129 = h1 * t3 * 1505.6122508018691;
  t130 = h1 * t2 * t104 * t121 * 4.5295194067444912E+12;
  t131 = h1 * t7 * t22 * 0.0076872873928263254;
  t132 = h1 * t121 * 1.024971652376843E+9;
  t133 = h1 * t3 * 2049.9433047536868;
  t134 = h1 * t2 * t104 * t121 * 6.1670977880676494E+12;
  t135 = h1 * t7 * t22 * 0.0016666666666666668;
  t136 = h1 * t121 * 2.2222222222222221E+8;
  t4 = h1 * t3 * 444.4444444444444;
  t3 = h1 * t2 * t104 * t121 * 1.3370771493515181E+12;
  x[0] = (((h1 * in3[4] * t21 * -0.19681547722366041 - h1 * t7 * t22 *
            0.0029522321583549068) - h1 * in3[5] * in3[6] * t5 * t9 * t20 *
           9.840773861183022E+7) - h1 * in3[2] * in3[5] * in3[6] * t5 * t12 *
          108.24851247301319) - 1.0;
  x[1] = t48 - h1 * in3[5] * in3[6] * t5 * t9 * t20 * 9.840773861183022E+7;
  x[2] = 0.0;
  x[3] = ((h1 * in3[5] * in3[6] * t5 * t9 * t20 * 1.9681547722366041E+8 + t48) +
          h1 * in3[2] * in3[5] * in3[6] * t5 * t12 * 108.24851247301319) *
    (-in3[6] * t49);
  x[4] = ((h1 * in3[4] * t21 * -0.39442431473908729 - h1 * t7 * t22 *
           0.0059163647210863091) - h1 * in3[5] * in3[6] * t9 * t62 * t70 *
          1.9721215736954361E+8) - h1 * in3[2] * in3[5] * in3[6] * t12 * t62 *
    216.933373106498;
  x[5] = t90 - h1 * in3[5] * in3[6] * t9 * t62 * t70 * 1.9721215736954361E+8;
  x[6] = 0.0;
  x[7] = ((h1 * in3[5] * in3[6] * t9 * t62 * t70 * 3.9442431473908728E+8 + t90)
          + h1 * in3[2] * in3[5] * in3[6] * t12 * t62 * 216.933373106498) *
    (-in3[6] * t49);
  x[8] = ((h1 * in3[4] * t21 * -0.37640306270046731 - h1 * t7 * t22 *
           0.0056460459405070088) - h1 * in3[5] * in3[6] * t9 * t104 * t112 *
          1.8820153135023361E+8) - h1 * in3[2] * in3[5] * in3[6] * t12 * t104 *
    207.021684485257;
  x[9] = t36 - h1 * in3[5] * in3[6] * t9 * t104 * t112 * 1.8820153135023361E+8;
  x[10] = 0.0;
  x[11] = ((h1 * in3[5] * in3[6] * t9 * t104 * t112 * 3.7640306270046729E+8 +
            t36) + h1 * in3[2] * in3[5] * in3[6] * t12 * t104 * 207.021684485257)
    * (-in3[6] * t49);
  x[12] = t29 - h1 * in3[5] * in3[6] * t5 * t9 * t15 * 9.840773861183022E+7;
  x[13] = ((-t29 - h1 * in3[4] * t21 * 0.19681547722366041) - h1 * in3[5] * in3
           [6] * t5 * t9 * t15 * 9.840773861183022E+7) - 1.0;
  x[14] = 0.0;
  x[15] = (t29 - h1 * in3[5] * in3[6] * t5 * t9 * t15 * 1.9681547722366041E+8) *
    (in3[6] * t49);
  x[16] = t72 - h1 * in3[5] * in3[6] * t9 * t62 * t66 * 1.9721215736954361E+8;
  x[17] = (-t72 - h1 * in3[4] * t21 * 0.39442431473908729) - h1 * in3[5] * in3[6]
    * t9 * t62 * t66 * 1.9721215736954361E+8;
  x[18] = 0.0;
  x[19] = (t72 - h1 * in3[5] * in3[6] * t9 * t62 * t66 * 3.9442431473908728E+8) *
    (in3[6] * t49);
  x[20] = t113 - h1 * in3[5] * in3[6] * t9 * t104 * t108 * 1.8820153135023361E+8;
  x[21] = (-t113 - h1 * in3[4] * t21 * 0.37640306270046731) - h1 * in3[5] * in3
    [6] * t9 * t104 * t108 * 1.8820153135023361E+8;
  x[22] = 0.0;
  x[23] = (t113 - h1 * in3[5] * in3[6] * t9 * t104 * t108 *
           3.7640306270046729E+8) * (in3[6] * t49);
  x[24] = 0.0;
  x[25] = 0.0;
  x[26] = (h1 * t42 * 787.26190889464181 - h1 * in3[4] * t21 *
           0.19681547722366041) - 1.0;
  x[27] = h1 * in3[6] * t42 * t49 * -787.26190889464181;
  x[28] = 0.0;
  x[29] = 0.0;
  x[30] = h1 * t84 * 1577.6972589563491 - h1 * in3[4] * t21 *
    0.39442431473908729;
  x[31] = h1 * in3[6] * t49 * t84 * -1577.6972589563491;
  x[32] = 0.0;
  x[33] = 0.0;
  x[34] = h1 * t10 * 1505.6122508018691 - h1 * in3[4] * t21 *
    0.37640306270046731;
  x[35] = h1 * in3[6] * t49 * t10 * -1505.6122508018691;
  x[36] = h1 * in3[5] * in3[6] * t9 * t15 * t20 * -9.840773861183022E+7 - h1 *
    in3[2] * in3[5] * in3[6] * t12 * t15 * 108.24851247301319;
  x[37] = h1 * in3[5] * in3[6] * t9 * t15 * t20 * -9.840773861183022E+7;
  x[38] = (t50 + t51) + t52;
  x[39] = ((h1 * in3[5] * in3[6] * t9 * t15 * t20 * 1.9681547722366041E+8 +
            ((t50 + t51) + t52)) + h1 * in3[2] * in3[5] * in3[6] * t12 * t15 *
           108.24851247301319) * (-in3[6] * t49) - 1.0;
  x[40] = h1 * in3[5] * in3[6] * t9 * t66 * t70 * -1.9721215736954361E+8 - h1 *
    in3[2] * in3[5] * in3[6] * t12 * t66 * 216.933373106498;
  x[41] = h1 * in3[5] * in3[6] * t9 * t66 * t70 * -1.9721215736954361E+8;
  x[42] = (t91 + t92) + t93;
  x[43] = ((h1 * in3[5] * in3[6] * t9 * t66 * t70 * 3.9442431473908728E+8 +
            ((t91 + t92) + t93)) + h1 * in3[2] * in3[5] * in3[6] * t12 * t66 *
           216.933373106498) * (-in3[6] * t49);
  x[44] = h1 * in3[5] * in3[6] * t9 * t108 * t112 * -1.8820153135023361E+8 - h1 *
    in3[2] * in3[5] * in3[6] * t12 * t108 * 207.021684485257;
  x[45] = h1 * in3[5] * in3[6] * t9 * t108 * t112 * -1.8820153135023361E+8;
  x[46] = (t128 + t129) + t130;
  x[47] = ((h1 * in3[5] * in3[6] * t9 * t108 * t112 * 3.7640306270046729E+8 +
            ((t128 + t129) + t130)) + h1 * in3[2] * in3[5] * in3[6] * t12 * t108
           * 207.021684485257) * (-in3[6] * t49);
  x[48] = ((t30 + t31) + t32) + t53;
  x[49] = -t30 + t31;
  x[50] = 0.0;
  x[51] = (h1 * in3[5] * in3[6] * t5 * t9 * t20 * 6.5535425850198381E+7 + (t30 +
            t53)) * (in3[6] * t49);
  x[52] = (((h1 * in3[4] * t21 * -0.29207341166522838 - h1 * t7 * t22 *
             0.0043811011749784259) - h1 * in3[5] * in3[6] * t9 * t62 * t70 *
            1.4603670583261421E+8) - h1 * in3[2] * in3[5] * in3[6] * t12 * t62 *
           160.64037641587561) - 1.0;
  x[53] = t94 - h1 * in3[5] * in3[6] * t9 * t62 * t70 * 1.4603670583261421E+8;
  x[54] = 0.0;
  x[55] = ((h1 * in3[5] * in3[6] * t9 * t62 * t70 * 2.9207341166522843E+8 + t94)
           + h1 * in3[2] * in3[5] * in3[6] * t12 * t62 * 160.64037641587561) * (
    -in3[6] * t49);
  x[56] = ((h1 * in3[4] * t21 * -0.51248582618842164 - h1 * t7 * t22 *
            0.0076872873928263254) - h1 * in3[5] * in3[6] * t9 * t104 * t112 *
           2.562429130942108E+8) - h1 * in3[2] * in3[5] * in3[6] * t12 * t104 *
    281.86720440363189;
  x[57] = t131 - h1 * in3[5] * in3[6] * t9 * t104 * t112 * 2.562429130942108E+8;
  x[58] = 0.0;
  x[59] = ((h1 * in3[5] * in3[6] * t9 * t104 * t112 * 5.1248582618842161E+8 +
            t131) + h1 * in3[2] * in3[5] * in3[6] * t12 * t104 *
           281.86720440363189) * (-in3[6] * t49);
  x[60] = t33 - h1 * in3[3] * t7 * t28 * 0.0081689908322272273;
  x[61] = (t32 + t33) + t54;
  x[62] = 0.0;
  x[63] = (t54 - h1 * in3[5] * in3[6] * t5 * t9 * t15 * 6.5535425850198381E+7) *
    (-in3[6] * t49);
  x[64] = t73 - h1 * in3[5] * in3[6] * t9 * t62 * t66 * 1.4603670583261421E+8;
  x[65] = ((-t73 - h1 * in3[4] * t21 * 0.29207341166522838) - h1 * in3[5] * in3
           [6] * t9 * t62 * t66 * 1.4603670583261421E+8) - 1.0;
  x[66] = 0.0;
  x[67] = (t73 - h1 * in3[5] * in3[6] * t9 * t62 * t66 * 2.9207341166522843E+8) *
    (in3[6] * t49);
  x[68] = t114 - h1 * in3[5] * in3[6] * t9 * t104 * t108 * 2.562429130942108E+8;
  x[69] = (-t114 - h1 * in3[4] * t21 * 0.51248582618842164) - h1 * in3[5] * in3
    [6] * t9 * t104 * t108 * 2.562429130942108E+8;
  x[70] = 0.0;
  x[71] = (t114 - h1 * in3[5] * in3[6] * t9 * t104 * t108 *
           5.1248582618842161E+8) * (in3[6] * t49);
  x[72] = 0.0;
  x[73] = 0.0;
  x[74] = t32 - h1 * t42 * 262.14170340079352;
  x[75] = h1 * in3[6] * t42 * t49 * 262.14170340079352;
  x[76] = 0.0;
  x[77] = 0.0;
  x[78] = (h1 * t84 * 1168.293646660914 - h1 * in3[4] * t21 *
           0.29207341166522838) - 1.0;
  x[79] = h1 * in3[6] * t49 * t84 * -1168.293646660914;
  x[80] = 0.0;
  x[81] = 0.0;
  x[82] = h1 * t10 * 2049.9433047536868 - h1 * in3[4] * t21 *
    0.51248582618842164;
  x[83] = h1 * in3[6] * t49 * t10 * -2049.9433047536868;
  x[84] = t34 + t55;
  x[85] = t34;
  x[86] = (h1 * t41 * -1.3107085170039681E+8 - h1 * t46 * 262.14170340079352) -
    h1 * t2 * t5 * t41 * 7.88633283395889E+11;
  x[87] = (h1 * in3[5] * in3[6] * t9 * t15 * t20 * 6.5535425850198381E+7 + (((h1
              * t41 * 1.3107085170039681E+8 + t55) + h1 * t46 *
             262.14170340079352) + h1 * t2 * t5 * t41 * 7.88633283395889E+11)) *
    (in3[6] * t49);
  x[88] = h1 * in3[5] * in3[6] * t9 * t66 * t70 * -1.4603670583261421E+8 - h1 *
    in3[2] * in3[5] * in3[6] * t12 * t66 * 160.64037641587561;
  x[89] = h1 * in3[5] * in3[6] * t9 * t66 * t70 * -1.4603670583261421E+8;
  x[90] = (t95 + t96) + t97;
  x[91] = ((h1 * in3[5] * in3[6] * t9 * t66 * t70 * 2.9207341166522843E+8 +
            ((t95 + t96) + t97)) + h1 * in3[2] * in3[5] * in3[6] * t12 * t66 *
           160.64037641587561) * (-in3[6] * t49) - 1.0;
  x[92] = h1 * in3[5] * in3[6] * t9 * t108 * t112 * -2.562429130942108E+8 - h1 *
    in3[2] * in3[5] * in3[6] * t12 * t108 * 281.86720440363189;
  x[93] = h1 * in3[5] * in3[6] * t9 * t108 * t112 * -2.562429130942108E+8;
  x[94] = (t132 + t133) + t134;
  x[95] = ((h1 * in3[5] * in3[6] * t9 * t108 * t112 * 5.1248582618842161E+8 +
            ((t132 + t133) + t134)) + h1 * in3[2] * in3[5] * in3[6] * t12 * t108
           * 281.86720440363189) * (-in3[6] * t49);
  x[96] = ((h1 * in3[4] * t21 * -0.023770974348220151 - h1 * t7 * t22 *
            0.00035656461522330229) - h1 * in3[5] * in3[6] * t5 * t9 * t20 *
           1.1885487174110079E+7) - h1 * in3[2] * in3[5] * in3[6] * t5 * t12 *
    13.074035891521079;
  x[97] = t56 - h1 * in3[5] * in3[6] * t5 * t9 * t20 * 1.1885487174110079E+7;
  x[98] = 0.0;
  x[99] = ((h1 * in3[5] * in3[6] * t5 * t9 * t20 * 2.3770974348220151E+7 + t56)
           + h1 * in3[2] * in3[5] * in3[6] * t5 * t12 * 13.074035891521079) *
    (-in3[6] * t49);
  x[100] = ((t74 + t75) + t76) + t98;
  x[101] = -t74 + t75;
  x[102] = 0.0;
  x[103] = (h1 * in3[5] * in3[6] * t9 * t62 * t70 * 4.1548752125997923E+7 + (t74
             + t98)) * (in3[6] * t49);
  x[104] = (((h1 * in3[4] * t21 * -0.1111111111111111 - h1 * t7 * t22 *
              0.0016666666666666668) - h1 * in3[5] * in3[6] * t9 * t104 * t112 *
             5.555555555555556E+7) - h1 * in3[2] * in3[5] * in3[6] * t12 * t104 *
            61.111111111111114) - 1.0;
  x[105] = t135 - h1 * in3[5] * in3[6] * t9 * t104 * t112 * 5.555555555555556E+7;
  x[106] = 0.0;
  x[107] = ((h1 * in3[5] * in3[6] * t9 * t104 * t112 * 1.111111111111111E+8 +
             t135) + h1 * in3[2] * in3[5] * in3[6] * t12 * t104 *
            61.111111111111114) * (-in3[6] * t49);
  x[108] = t35 - h1 * in3[5] * in3[6] * t5 * t9 * t15 * 1.1885487174110079E+7;
  x[109] = (-t35 - h1 * in3[4] * t21 * 0.023770974348220151) - h1 * in3[5] *
    in3[6] * t5 * t9 * t15 * 1.1885487174110079E+7;
  x[110] = 0.0;
  x[111] = (t35 - h1 * in3[5] * in3[6] * t5 * t9 * t15 * 2.3770974348220151E+7) *
    (in3[6] * t49);
  x[112] = t77 - h1 * in3[3] * t7 * t28 * 0.0051790519525056408;
  x[113] = (t76 + t77) + t99;
  x[114] = 0.0;
  x[115] = (t99 - h1 * in3[5] * in3[6] * t9 * t62 * t66 * 4.1548752125997923E+7)
    * (-in3[6] * t49);
  x[116] = t115 - h1 * in3[5] * in3[6] * t9 * t104 * t108 * 5.555555555555556E+7;
  x[117] = ((-t115 - h1 * in3[4] * t21 * 0.1111111111111111) - h1 * in3[5] *
            in3[6] * t9 * t104 * t108 * 5.555555555555556E+7) - 1.0;
  x[118] = 0.0;
  x[119] = (t115 - h1 * in3[5] * in3[6] * t9 * t104 * t108 *
            1.111111111111111E+8) * (in3[6] * t49);
  x[120] = 0.0;
  x[121] = 0.0;
  x[122] = h1 * t42 * 95.0838973928806 - h1 * in3[4] * t21 *
    0.023770974348220151;
  x[123] = h1 * in3[6] * t42 * t49 * -95.0838973928806;
  x[124] = 0.0;
  x[125] = 0.0;
  x[126] = t76 - h1 * t84 * 166.19500850399169;
  x[127] = h1 * in3[6] * t49 * t84 * 166.19500850399169;
  x[128] = 0.0;
  x[129] = 0.0;
  x[130] = (h1 * t10 * 444.4444444444444 - h1 * in3[4] * t21 *
            0.1111111111111111) - 1.0;
  x[131] = h1 * in3[6] * t49 * t10 * -444.4444444444444;
  x[132] = h1 * in3[5] * in3[6] * t9 * t15 * t20 * -1.1885487174110079E+7 - h1 *
    in3[2] * in3[5] * in3[6] * t12 * t15 * 13.074035891521079;
  x[133] = h1 * in3[5] * in3[6] * t9 * t15 * t20 * -1.1885487174110079E+7;
  x[134] = (t57 + t58) + t59;
  x[135] = ((h1 * in3[5] * in3[6] * t9 * t15 * t20 * 2.3770974348220151E+7 +
             ((t57 + t58) + t59)) + h1 * in3[2] * in3[5] * in3[6] * t12 * t15 *
            13.074035891521079) * (-in3[6] * t49);
  x[136] = t78 + t100;
  x[137] = t78;
  x[138] = (h1 * t83 * -8.3097504251995847E+7 - h1 * t88 * 166.19500850399169) -
    h1 * t2 * t62 * t83 * 4.9998498346567889E+11;
  x[139] = (h1 * in3[5] * in3[6] * t9 * t66 * t70 * 4.1548752125997923E+7 +
            (((h1 * t83 * 8.3097504251995847E+7 + t100) + h1 * t88 *
              166.19500850399169) + h1 * t2 * t62 * t83 * 4.9998498346567889E+11))
    * (in3[6] * t49);
  x[140] = h1 * in3[5] * in3[6] * t9 * t108 * t112 * -5.555555555555556E+7 - h1 *
    in3[2] * in3[5] * in3[6] * t12 * t108 * 61.111111111111114;
  x[141] = h1 * in3[5] * in3[6] * t9 * t108 * t112 * -5.555555555555556E+7;
  x[142] = (t136 + t4) + t3;
  x[143] = ((h1 * in3[5] * in3[6] * t9 * t108 * t112 * 1.111111111111111E+8 +
             ((t136 + t4) + t3)) + h1 * in3[2] * in3[5] * in3[6] * t12 * t108 *
            61.111111111111114) * (-in3[6] * t49) - 1.0;
  memcpy(&JFk[0], &x[0], 144U * sizeof(real_T));
}

/* Function for MATLAB Function: '<Root>/RTI_prepare' */
static void uln_rti_linux_F_mfcn(const real_T in1[4], real_T u1, const real_T
  in3[7], const real_T in4[12], real_T h1, real_T F[12])
{
  real_T t2;
  real_T t5;
  real_T t6;
  real_T t10;
  real_T t11;
  real_T t12;
  real_T t25;
  real_T t13;
  real_T t15;
  real_T t16;
  real_T t20;
  real_T t22;
  real_T t24;
  real_T t28;
  real_T t31;
  real_T t32;
  real_T t38;
  real_T t41;
  real_T t44;
  real_T t45;
  real_T t48;
  real_T t53;
  real_T t56;
  real_T t59;
  real_T t60;
  real_T t62;
  real_T t65;
  real_T t66;
  real_T t72;
  real_T t75;
  real_T t77;
  real_T t81;
  real_T t85;
  real_T t87;
  real_T t88;
  real_T t89;

  /* F_MFCN */
  /*     F = F_MFCN(IN1,U1,IN3,IN4,H1) */
  /*     This function was generated by the Symbolic Math Toolbox version 6.1. */
  /*     04-Apr-2017 15:23:19 */
  t2 = 1.0 / in3[6];
  t5 = ((h1 * in4[0] * 0.19681547722366041 + h1 * in4[8] * 0.023770974348220151)
        - h1 * in4[4] * 0.065535425850198378) + in1[0];
  t6 = 1.0 / in3[3];
  t10 = ((h1 * in4[1] * 0.19681547722366041 + h1 * in4[9] * 0.023770974348220151)
         - h1 * in4[5] * 0.065535425850198378) + in1[1];
  t11 = h1 * in4[3] * 0.19681547722366041;
  t12 = h1 * in4[11] * 0.023770974348220151;
  t25 = h1 * in4[7] * 0.065535425850198378;
  t13 = ((t11 + t12) - t25) + in1[3];
  t15 = exp(-(t6 * 3489.7713598074611) + 7.3779521348994939);
  t16 = sqrt(in3[2]);
  t20 = 1.0 / (in3[3] * 13.0 - 20000.0);
  t22 = t5 * t16 - in3[3] * t10 * t20 * 8.31;
  t24 = exp(-(t6 * 9626.9554753309258) + 20.352971406619289);
  t28 = ((h1 * in4[2] * 0.19681547722366041 + h1 * in4[10] *
          0.023770974348220151) - h1 * in4[6] * 0.065535425850198378) + in1[2];
  t31 = t15 * t22 * 0.015;
  t32 = in1[3] * 6016.8471720818288;
  t38 = exp(((((h1 * in4[3] * 1184.2086475551171 + t32) + h1 * in4[11] *
               143.02631978471811) - h1 * in4[7] * 394.31664169794448) -
             12033.694344163659) * t6) * t13 * 2.0E+9;
  t41 = ((((t11 + t12) - t25) + in1[3]) - 1.0) * t28 * 4000.0;
  t44 = exp(-(t6 * 6016.8471720818288) + 12.720607129137059);
  t45 = in3[0] * in3[4] * t2;
  t48 = ((h1 * in4[0] * 0.39442431473908729 + h1 * in4[4] * 0.29207341166522838)
         - h1 * in4[8] * 0.041548752125997922) + in1[0];
  t53 = ((h1 * in4[1] * 0.39442431473908729 + h1 * in4[5] * 0.29207341166522838)
         - h1 * in4[9] * 0.041548752125997922) + in1[1];
  t11 = h1 * in4[3] * 0.39442431473908729;
  t12 = h1 * in4[7] * 0.29207341166522838;
  t25 = h1 * in4[11] * 0.041548752125997922;
  t56 = ((t11 + t12) - t25) + in1[3];
  t59 = t16 * t48 - in3[3] * t20 * t53 * 8.31;
  t60 = in3[1] * in3[4] * t2;
  t62 = in3[4] * t2 * u1;
  t65 = ((h1 * in4[2] * 0.39442431473908729 + h1 * in4[6] * 0.29207341166522838)
         - h1 * in4[10] * 0.041548752125997922) + in1[2];
  t66 = 1.0 / in3[5];
  t72 = exp(((((h1 * in4[3] * 2373.1908227381909 + t32) + h1 * in4[7] *
               1757.361081018222) - h1 * in4[11] * 249.99249173283951) -
             12033.694344163659) * t6) * t56 * 2.0E+9;
  t75 = ((((t11 + t12) - t25) + in1[3]) - 1.0) * t65 * 4000.0;
  t77 = t15 * t59 * 0.015;
  t81 = ((h1 * in4[0] * 0.37640306270046731 + h1 * in4[4] * 0.51248582618842164)
         + h1 * in4[8] * 0.1111111111111111) + in1[0];
  t85 = ((h1 * in4[1] * 0.37640306270046731 + h1 * in4[5] * 0.51248582618842164)
         + h1 * in4[9] * 0.1111111111111111) + in1[1];
  t11 = h1 * in4[3] * 0.37640306270046731;
  t87 = h1 * in4[7] * 0.51248582618842164;
  t88 = h1 * in4[11] * 0.1111111111111111;
  t89 = ((t11 + t87) + t88) + in1[3];
  t25 = t16 * t81 - in3[3] * t20 * t85 * 8.31;
  t16 = ((h1 * in4[2] * 0.37640306270046731 + h1 * in4[6] * 0.51248582618842164)
         + h1 * in4[10] * 0.1111111111111111) + in1[2];
  t20 = t15 * t25 * 0.015;
  t12 = exp(((((h1 * in4[3] * 2264.7597033722459 + t32) + h1 * in4[7] *
               3083.5488940338241) + h1 * in4[11] * 668.53857467575881) -
             12033.694344163659) * t6) * t89 * 2.0E+9;
  t11 = ((((t11 + t87) + t88) + in1[3]) - 1.0) * t16 * 4000.0;
  F[0] = ((((-in4[0] + t45) - t15 * t22 * 0.015) - in3[4] * t2 * t5) - in3[2] *
          in3[5] * in3[6] * t5 * t13 * t44 * 550.0) - in3[5] * in3[6] * t5 * t10
    * t13 * t24 * 5.0E+8;
  F[1] = (((-in4[1] + t31) + t60) - in3[4] * t2 * t10) - in3[5] * in3[6] * t5 *
    t10 * t13 * t24 * 5.0E+8;
  F[2] = (((-in4[2] + t38) + t41) + t62) - in3[4] * t2 * t28;
  F[3] = -in4[3] - ((in3[2] * in3[5] * in3[6] * t5 * t13 * t44 * 550.0 + ((t31 +
    t38) + t41)) + in3[5] * in3[6] * t5 * t10 * t13 * t24 * 1.0E+9) * (in3[6] *
    t66);
  F[4] = ((((-in4[4] + t45) - t15 * t59 * 0.015) - in3[4] * t2 * t48) - in3[2] *
          in3[5] * in3[6] * t44 * t48 * t56 * 550.0) - in3[5] * in3[6] * t24 *
    t48 * t53 * t56 * 5.0E+8;
  F[5] = (((-in4[5] + t60) + t77) - in3[4] * t2 * t53) - in3[5] * in3[6] * t24 *
    t48 * t53 * t56 * 5.0E+8;
  F[6] = (((-in4[6] + t62) + t72) + t75) - in3[4] * t2 * t65;
  F[7] = -in4[7] - ((in3[2] * in3[5] * in3[6] * t44 * t48 * t56 * 550.0 + ((t72
    + t75) + t77)) + in3[5] * in3[6] * t24 * t48 * t53 * t56 * 1.0E+9) * (in3[6]
    * t66);
  F[8] = ((((-in4[8] + t45) - t15 * t25 * 0.015) - in3[4] * t2 * t81) - in3[2] *
          in3[5] * in3[6] * t44 * t81 * t89 * 550.0) - in3[5] * in3[6] * t24 *
    t81 * t85 * t89 * 5.0E+8;
  F[9] = (((-in4[9] + t60) + t20) - in3[4] * t2 * t85) - in3[5] * in3[6] * t24 *
    t81 * t85 * t89 * 5.0E+8;
  F[10] = (((-in4[10] + t62) + t12) + t11) - in3[4] * t2 * t16;
  F[11] = -in4[11] - ((in3[2] * in3[5] * in3[6] * t44 * t81 * t89 * 550.0 +
                       ((t20 + t12) + t11)) + in3[5] * in3[6] * t24 * t81 * t85 *
                      t89 * 1.0E+9) * (in3[6] * t66);
}

/* Function for MATLAB Function: '<Root>/RTI_prepare' */
static void uln_rti_linux_mldivide(const real_T A[144], real_T B[12])
{
  real_T temp;
  real_T b_A[144];
  int8_T ipiv[12];
  int32_T j;
  int32_T c;
  int32_T ix;
  real_T s;
  int32_T jy;
  int32_T c_ix;
  int32_T d;
  int32_T ijA;
  int32_T b_kAcol;
  memcpy(&b_A[0], &A[0], 144U * sizeof(real_T));
  for (j = 0; j < 12; j++) {
    ipiv[j] = (int8_T)(1 + j);
  }

  for (j = 0; j < 11; j++) {
    c = j * 13;
    jy = 0;
    ix = c;
    temp = fabs(b_A[c]);
    for (b_kAcol = 2; b_kAcol <= 12 - j; b_kAcol++) {
      ix++;
      s = fabs(b_A[ix]);
      if (s > temp) {
        jy = b_kAcol - 1;
        temp = s;
      }
    }

    if (b_A[c + jy] != 0.0) {
      if (jy != 0) {
        ipiv[j] = (int8_T)((j + jy) + 1);
        ix = j;
        b_kAcol = j + jy;
        for (jy = 0; jy < 12; jy++) {
          temp = b_A[ix];
          b_A[ix] = b_A[b_kAcol];
          b_A[b_kAcol] = temp;
          ix += 12;
          b_kAcol += 12;
        }
      }

      ix = (c - j) + 12;
      for (b_kAcol = c + 1; b_kAcol + 1 <= ix; b_kAcol++) {
        b_A[b_kAcol] /= b_A[c];
      }
    }

    b_kAcol = c;
    jy = c + 12;
    for (ix = 1; ix <= 11 - j; ix++) {
      temp = b_A[jy];
      if (b_A[jy] != 0.0) {
        c_ix = c + 1;
        d = (b_kAcol - j) + 24;
        for (ijA = 13 + b_kAcol; ijA + 1 <= d; ijA++) {
          b_A[ijA] += b_A[c_ix] * -temp;
          c_ix++;
        }
      }

      jy += 12;
      b_kAcol += 12;
    }
  }

  for (ix = 0; ix < 11; ix++) {
    if (ix + 1 != ipiv[ix]) {
      temp = B[ix];
      B[ix] = B[ipiv[ix] - 1];
      B[ipiv[ix] - 1] = temp;
    }
  }

  for (ix = 0; ix < 12; ix++) {
    b_kAcol = 12 * ix;
    if (B[ix] != 0.0) {
      for (jy = ix + 1; jy + 1 < 13; jy++) {
        B[jy] -= b_A[jy + b_kAcol] * B[ix];
      }
    }
  }

  for (ix = 11; ix >= 0; ix += -1) {
    b_kAcol = 12 * ix;
    if (B[ix] != 0.0) {
      B[ix] /= b_A[ix + b_kAcol];
      for (jy = 0; jy + 1 <= ix; jy++) {
        B[jy] -= b_A[jy + b_kAcol] * B[ix];
      }
    }
  }
}

/* Model step function */
void uln_rti_linux_step(void)
{
  /* local block i/o variables */
  real_T rtb_RQP_wrp_o1[30];
  real_T rtb_RQP_wrp_o2[150];
  real_T rtb_RQP_wrp_o3;
  real_T rtb_gl[30];
  real_T rtb_gu[30];
  real_T rtb_Bc[30];
  real_T rtb_glA[120];
  real_T rtb_guA[120];
  real_T B[154];
  int8_T rem_its;
  int8_T blk_i_nx[4];
  uint8_T blk_i_nx_p1_sz[4];
  uint8_T blk_i_nx_sz[4];
  real_T dgdz_blk[20];
  real_T JFk[144];
  real_T JFz[60];
  real_T k_irk[12];
  real_T dk_irk[12];
  int32_T i;
  int32_T b_i;
  real_T rtb_w2[120];
  real_T rtb_znew[154];
  real_T rtb_deltax0[4];
  real_T rtb_d[120];
  real_T rtb_C[480];
  real_T tmp[60];
  real_T tmp_0[12];
  int32_T i_0;
  real_T EtQbar[30];
  real_T tmp_1[30];
  real_T EtQbar_0[120];
  int32_T i_1;
  real_T EtQbar_1[30];
  real_T tmp_2[120];
  int32_T i_2;
  uint8_T b_i_0;
  uint8_T tmp_3[5];
  real_T rtb_C_0[16];
  real_T rtb_znew_0[4];
  int8_T blk_i_nx_m1_idx_0;
  int8_T blk_i_nx_m1_idx_1;
  int8_T blk_i_nx_m1_idx_2;
  int8_T blk_i_nx_m1_idx_3;
  real_T unnamed_idx_1;
  real_T unnamed_idx_2;
  real_T unnamed_idx_3;
  real_T EtQbar_2;

  /* MATLAB Function: '<Root>/RTI_prepare' incorporates:
   *  Constant: '<Root>/Constant12'
   *  Constant: '<Root>/Constant13'
   *  Constant: '<Root>/Constant15'
   *  Constant: '<Root>/Constant17'
   *  Constant: '<Root>/Constant18'
   *  Constant: '<Root>/Constant19'
   *  Constant: '<Root>/Constant2'
   *  Constant: '<Root>/Constant20'
   *  Constant: '<Root>/Constant21'
   *  Constant: '<Root>/Constant22'
   *  Constant: '<Root>/Constant23'
   *  Constant: '<Root>/Constant5'
   *  UnitDelay: '<Root>/z_store'
   */
  /* MATLAB Function 'RTI_prepare': '<S3>:1' */
  /* rti_prepare The preparation step of a real-time iterations NMPC algorithm */
  /*  */
  /*  Jon Sowman 2016 */
  /*  j.sowman@soton.ac.uk */
  /*  */
  /*  All rights reserved */
  /*  */
  /*  z        - the current DMS vector */
  /*  p        - model parameters */
  /*  data     - problem data */
  /*  Storage preallocation for EmbeddedCoder size determination */
  /* '<S3>:1:15' */
  memcpy(&rtb_znew[0], &uln_rti_linux_DW.z_store_DSTATE[0], 154U * sizeof(real_T));

  /* '<S3>:1:16' */
  memset(&rtb_C[0], 0, 480U * sizeof(real_T));

  /* '<S3>:1:17' */
  memset(&uln_rti_linux_B.E[0], 0, 3600U * sizeof(real_T));

  /* '<S3>:1:18' */
  memset(&rtb_d[0], 0, 120U * sizeof(real_T));

  /* '<S3>:1:21' */
  /*  Other allocation */
  /* '<S3>:1:31' */
  rem_its = 10;

  /* '<S3>:1:32' */
  /* '<S3>:1:33' */
  /* '<S3>:1:34' */
  /*  IRK allocation */
  /* '<S3>:1:44' */
  memset(&dgdz_blk[0], 0, 20U * sizeof(real_T));

  /* '<S3>:1:45' */
  memset(&JFk[0], 0, 144U * sizeof(real_T));

  /* '<S3>:1:49' */
  memset(&k_irk[0], 0, 12U * sizeof(real_T));

  /* '<S3>:1:58' */
  /*  Find the objective and its gradient */
  /*  Naively: B = gn_hessian * z; */
  /*  Our Hessian is truly diagonal so we can get away with this: */
  /* '<S3>:1:63' */
  for (i = 0; i < 154; i++) {
    /* '<S3>:1:63' */
    /* '<S3>:1:64' */
    B[i] = uln_rti_linux_ConstP.Constant12_Value[154 * i + i] *
      uln_rti_linux_DW.z_store_DSTATE[i];

    /* '<S3>:1:63' */
  }

  /*  Run IRK for : z_i in z \forall i \in N */
  /*  This for loop could be parallelised */
  /* '<S3>:1:69' */
  for (b_i = 0; b_i < 30; b_i++) {
    /* '<S3>:1:69' */
    /*  Subscripts for this loop iteration */
    /* '<S3>:1:71' */
    blk_i_nx_m1_idx_3 = (int8_T)(b_i * (int32_T)4.0);
    blk_i_nx[0] = (int8_T)(1 + blk_i_nx_m1_idx_3);
    blk_i_nx[1] = (int8_T)(2 + blk_i_nx_m1_idx_3);
    blk_i_nx[2] = (int8_T)(3 + blk_i_nx_m1_idx_3);
    blk_i_nx[3] = (int8_T)(4 + blk_i_nx_m1_idx_3);

    /*  equiv to myMat(bs(i,nx):be(i,nx)) */
    /* '<S3>:1:72' */
    blk_i_nx_m1_idx_3 = (int8_T)((b_i - 1) * (int32_T)4.0);
    blk_i_nx_m1_idx_0 = (int8_T)(1 + blk_i_nx_m1_idx_3);
    blk_i_nx_m1_idx_1 = (int8_T)(2 + blk_i_nx_m1_idx_3);
    blk_i_nx_m1_idx_2 = (int8_T)(3 + blk_i_nx_m1_idx_3);
    blk_i_nx_m1_idx_3 = (int8_T)(4 + blk_i_nx_m1_idx_3);

    /*  equiv to myMat(bs(i-1,nx):be(i-1,nx)) */
    /* '<S3>:1:73' */
    b_i_0 = (uint8_T)((1 + b_i) * (uint32_T)uln_rti_linux_sz);
    blk_i_nx_p1_sz[0] = (uint8_T)(1U + b_i_0);
    blk_i_nx_p1_sz[1] = (uint8_T)(2U + b_i_0);
    blk_i_nx_p1_sz[2] = (uint8_T)(3U + b_i_0);
    blk_i_nx_p1_sz[3] = (uint8_T)(4U + b_i_0);

    /*  equiv to myMat(bs(i+1,nx):be(i+1,nx)) */
    /* '<S3>:1:74' */
    /*  equiv to myMat(bs(i,nu):be(i,nu)) */
    /* '<S3>:1:75' */
    /*  equiv to myMat(bs(i,sz):be(i,sz)) */
    /* '<S3>:1:76' */
    b_i_0 = (uint8_T)(b_i * (uint32_T)uln_rti_linux_sz);
    blk_i_nx_sz[0] = (uint8_T)(1U + b_i_0);
    blk_i_nx_sz[1] = (uint8_T)(2U + b_i_0);
    blk_i_nx_sz[2] = (uint8_T)(3U + b_i_0);
    blk_i_nx_sz[3] = (uint8_T)(4U + b_i_0);

    /*  equiv to myMat(bs(i,sz):be(i,sz)-1) */
    /* %%%%%%%%%%%%%%% BEGIN IRK %%%%%%%%%%%%%%%% */
    /* '<S3>:1:79' */
    /* '<S3>:1:80' */
    i = b_i * (int32_T)uln_rti_linux_sz;
    for (i_0 = 0; i_0 < 5; i_0++) {
      tmp_3[i_0] = (uint8_T)((i_0 + i) + 1);
    }

    rtb_deltax0[0] = uln_rti_linux_DW.z_store_DSTATE[tmp_3[0] - 1];
    rtb_deltax0[1] = uln_rti_linux_DW.z_store_DSTATE[tmp_3[1] - 1];
    rtb_deltax0[2] = uln_rti_linux_DW.z_store_DSTATE[tmp_3[2] - 1];
    rtb_deltax0[3] = uln_rti_linux_DW.z_store_DSTATE[tmp_3[3] - 1];

    /* '<S3>:1:81' */
    /*  Run IRK steps to cross the shooting node */
    /* '<S3>:1:83' */
    for (i = 0; i < 11; i++) {
      /* '<S3>:1:83' */
      /*  Run Newton iterations */
      while (rem_its > 0) {
        /* '<S3>:1:85' */
        /*  || norm(dk) > 1e-6 */
        /*  Using exact grad-F turns out to be a lot more robust and can */
        /*  use fewer Newton steps */
        /* '<S3>:1:88' */
        uln_rti_linux_JFk_mfcn(rtb_deltax0,
          uln_rti_linux_ConstP.Constant23_Value, k_irk, 0.05, JFk);

        /*  Find F */
        /* '<S3>:1:90' */
        /*  Newton step */
        /* [dk, dKQ, dKR] = lsq_householder(JFk, -F); */
        /* dk = lsq_lapack(JFk, -F); */
        /* '<S3>:1:94' */
        uln_rti_linux_F_mfcn(rtb_deltax0, uln_rti_linux_DW.z_store_DSTATE[b_i *
                             (int32_T)uln_rti_linux_sz + 4],
                             uln_rti_linux_ConstP.Constant23_Value, k_irk, 0.05,
                             tmp_0);
        for (i_0 = 0; i_0 < 12; i_0++) {
          dk_irk[i_0] = -tmp_0[i_0];
        }

        uln_rti_linux_mldivide(JFk, dk_irk);

        /* '<S3>:1:95' */
        for (i_0 = 0; i_0 < 12; i_0++) {
          k_irk[i_0] += dk_irk[i_0];
        }

        /* '<S3>:1:96' */
        rem_its--;
      }

      /*  We have k, apply IRK update to get new state */
      /* '<S3>:1:99' */
      /*  Sensitivity */
      /* '<S3>:1:101' */
      /* '<S3>:1:102' */
      uln_rti_linux_JFz_mfcn(rtb_deltax0, uln_rti_linux_ConstP.Constant23_Value,
        k_irk, 0.05, tmp);
      for (i_0 = 0; i_0 < 60; i_0++) {
        JFz[i_0] = -tmp[i_0];
      }

      uln_rti_linux_mldivide_j(JFk, JFz);

      /*  IRK update equation for sensitivity (IFT applied to IRK update) */
      /* '<S3>:1:104' */
      for (i_0 = 0; i_0 < 4; i_0++) {
        for (i_2 = 0; i_2 < 5; i_2++) {
          EtQbar_2 = 0.0;
          for (i_1 = 0; i_1 < 12; i_1++) {
            EtQbar_2 += uln_rti_linux_ConstP.Constant15_Value[(i_1 << 2) + i_0] *
              JFz[12 * i_2 + i_1];
          }

          dgdz_blk[i_0 + (i_2 << 2)] = uln_rti_linux_ConstP.Constant17_Value
            [(i_2 << 2) + i_0] + EtQbar_2;
        }
      }

      /*  Reallocate */
      /* '<S3>:1:106' */
      for (i_0 = 0; i_0 < 4; i_0++) {
        EtQbar_2 = 0.0;
        for (i_2 = 0; i_2 < 12; i_2++) {
          EtQbar_2 += uln_rti_linux_ConstP.Constant15_Value[(i_2 << 2) + i_0] *
            k_irk[i_2];
        }

        rtb_deltax0[i_0] += EtQbar_2;
      }

      /*  Remaining */
      /* '<S3>:1:108' */
      rem_its = 10;

      /* '<S3>:1:83' */
    }

    /*  Put result into z_new */
    /* '<S3>:1:111' */
    rtb_znew[blk_i_nx_sz[0] - 1] = rtb_deltax0[0];
    rtb_znew[blk_i_nx_sz[1] - 1] = rtb_deltax0[1];
    rtb_znew[blk_i_nx_sz[2] - 1] = rtb_deltax0[2];
    rtb_znew[blk_i_nx_sz[3] - 1] = rtb_deltax0[3];

    /* %%%%%%%%%%%%%%% END IRK %%%%%%%%%%%%%%%% */
    /*  Relevant block of C */
    if (1 + b_i == 1) {
      /* '<S3>:1:114' */
      /*  C0 = A0, C1 = A1*C0, C2 = A2*C1, etc */
      /* '<S3>:1:115' */
      for (i_0 = 0; i_0 < 4; i_0++) {
        rtb_C[(blk_i_nx[0] + 120 * i_0) - 1] = dgdz_blk[i_0 << 2];
        rtb_C[(blk_i_nx[1] + 120 * i_0) - 1] = dgdz_blk[(i_0 << 2) + 1];
        rtb_C[(blk_i_nx[2] + 120 * i_0) - 1] = dgdz_blk[(i_0 << 2) + 2];
        rtb_C[(blk_i_nx[3] + 120 * i_0) - 1] = dgdz_blk[(i_0 << 2) + 3];
      }
    } else {
      /* '<S3>:1:117' */
      for (i_0 = 0; i_0 < 4; i_0++) {
        rtb_C_0[i_0 << 2] = rtb_C[(120 * i_0 + blk_i_nx_m1_idx_0) - 1];
        rtb_C_0[1 + (i_0 << 2)] = rtb_C[(120 * i_0 + blk_i_nx_m1_idx_1) - 1];
        rtb_C_0[2 + (i_0 << 2)] = rtb_C[(120 * i_0 + blk_i_nx_m1_idx_2) - 1];
        rtb_C_0[3 + (i_0 << 2)] = rtb_C[(120 * i_0 + blk_i_nx_m1_idx_3) - 1];
      }

      for (i_0 = 0; i_0 < 4; i_0++) {
        for (i_2 = 0; i_2 < 4; i_2++) {
          rtb_C[(blk_i_nx[i_0] + 120 * i_2) - 1] = 0.0;
          rtb_C[(blk_i_nx[i_0] + 120 * i_2) - 1] += rtb_C_0[i_2 << 2] *
            dgdz_blk[i_0];
          rtb_C[(blk_i_nx[i_0] + 120 * i_2) - 1] += rtb_C_0[(i_2 << 2) + 1] *
            dgdz_blk[i_0 + 4];
          rtb_C[(blk_i_nx[i_0] + 120 * i_2) - 1] += rtb_C_0[(i_2 << 2) + 2] *
            dgdz_blk[i_0 + 8];
          rtb_C[(blk_i_nx[i_0] + 120 * i_2) - 1] += rtb_C_0[(i_2 << 2) + 3] *
            dgdz_blk[i_0 + 12];
        }
      }
    }

    /*  And E diagonals */
    /* '<S3>:1:120' */
    uln_rti_linux_B.E[(blk_i_nx[0] + 120 * b_i) - 1] = dgdz_blk[16];
    uln_rti_linux_B.E[(blk_i_nx[1] + 120 * b_i) - 1] = dgdz_blk[17];
    uln_rti_linux_B.E[(blk_i_nx[2] + 120 * b_i) - 1] = dgdz_blk[18];
    uln_rti_linux_B.E[(blk_i_nx[3] + 120 * b_i) - 1] = dgdz_blk[19];

    /*  E below-diagonals */
    /* '<S3>:1:122' */
    for (i = 0; i < b_i; i++) {
      /* '<S3>:1:122' */
      /* '<S3>:1:123' */
      /* '<S3>:1:124' */
      EtQbar_2 = uln_rti_linux_B.E[(120 * i + blk_i_nx_m1_idx_0) - 1];
      unnamed_idx_1 = uln_rti_linux_B.E[(120 * i + blk_i_nx_m1_idx_1) - 1];
      unnamed_idx_2 = uln_rti_linux_B.E[(120 * i + blk_i_nx_m1_idx_2) - 1];
      unnamed_idx_3 = uln_rti_linux_B.E[(120 * i + blk_i_nx_m1_idx_3) - 1];
      for (i_0 = 0; i_0 < 4; i_0++) {
        uln_rti_linux_B.E[(blk_i_nx[i_0] + 120 * i) - 1] = 0.0;
        uln_rti_linux_B.E[(blk_i_nx[i_0] + 120 * i) - 1] += dgdz_blk[i_0] *
          EtQbar_2;
        uln_rti_linux_B.E[(blk_i_nx[i_0] + 120 * i) - 1] += dgdz_blk[i_0 + 4] *
          unnamed_idx_1;
        uln_rti_linux_B.E[(blk_i_nx[i_0] + 120 * i) - 1] += dgdz_blk[i_0 + 8] *
          unnamed_idx_2;
        uln_rti_linux_B.E[(blk_i_nx[i_0] + 120 * i) - 1] += dgdz_blk[i_0 + 12] *
          unnamed_idx_3;
      }

      /* '<S3>:1:122' */
    }

    /*  d vector */
    if (1 + b_i == 1) {
      /* '<S3>:1:127' */
      /* '<S3>:1:128' */
      rtb_d[blk_i_nx[0] - 1] = rtb_znew[blk_i_nx_sz[0] - 1] -
        uln_rti_linux_DW.z_store_DSTATE[blk_i_nx_p1_sz[0] - 1];
      rtb_d[blk_i_nx[1] - 1] = rtb_znew[blk_i_nx_sz[1] - 1] -
        uln_rti_linux_DW.z_store_DSTATE[blk_i_nx_p1_sz[1] - 1];
      rtb_d[blk_i_nx[2] - 1] = rtb_znew[blk_i_nx_sz[2] - 1] -
        uln_rti_linux_DW.z_store_DSTATE[blk_i_nx_p1_sz[2] - 1];
      rtb_d[blk_i_nx[3] - 1] = rtb_znew[blk_i_nx_sz[3] - 1] -
        uln_rti_linux_DW.z_store_DSTATE[blk_i_nx_p1_sz[3] - 1];
    } else {
      /* '<S3>:1:131' */
      for (i_0 = 0; i_0 < 4; i_0++) {
        rtb_znew_0[i_0] = (((rtb_d[blk_i_nx_m1_idx_0 - 1] * dgdz_blk[i_0] +
                             dgdz_blk[i_0 + 4] * rtb_d[blk_i_nx_m1_idx_1 - 1]) +
                            dgdz_blk[i_0 + 8] * rtb_d[blk_i_nx_m1_idx_2 - 1]) +
                           dgdz_blk[i_0 + 12] * rtb_d[blk_i_nx_m1_idx_3 - 1]) +
          (rtb_znew[blk_i_nx_sz[i_0] - 1] -
           uln_rti_linux_DW.z_store_DSTATE[blk_i_nx_p1_sz[i_0] - 1]);
      }

      rtb_d[blk_i_nx[0] - 1] = rtb_znew_0[0];
      rtb_d[blk_i_nx[1] - 1] = rtb_znew_0[1];
      rtb_d[blk_i_nx[2] - 1] = rtb_znew_0[2];
      rtb_d[blk_i_nx[3] - 1] = rtb_znew_0[3];
    }

    /* '<S3>:1:69' */
  }

  /*  Bounds on delta-u */
  /* '<S3>:1:138' */
  /* '<S3>:1:139' */
  /*  Bounds on states */
  /* '<S3>:1:142' */
  for (i_0 = 0; i_0 < 120; i_0++) {
    rtb_w2[i_0] = 0.0;
    for (i_2 = 0; i_2 < 154; i_2++) {
      rtb_w2[i_0] += uln_rti_linux_ConstP.Constant13_Value[(124 * i_2 + i_0) + 4]
        * uln_rti_linux_DW.z_store_DSTATE[i_2];
    }
  }

  /*  was vx(bs(2,nx):end, :)*z */
  /* deltax0 = x0 - z(1:nx); wait for feedback */
  /* '<S3>:1:144' */
  /*  + C * deltax0; % wait for feedback */
  /* glA_prep = repmat(data.xmin, N, 1);%vx - w2tild; */
  /* guA_prep = repmat(data.xmax, N, 1);% - w2tild; */
  /*  Construct the condensed Hessian and linear term */
  /* Qbar = kron(eye(N), diag(data.wgts(1:nx))); */
  /* Rbar = kron(eye(N), diag(data.wgts(nx+1:end))); */
  /* NAIVE: Ac = E'*Qbar*E + Rbar; */
  /*  Find E transpose times Qbar (Qbar is diagonal) */
  /*      for i = 1:nu*N */
  /*          for j = (i-1)*nx+1:N*nx */
  /*              EtQbar(i,j) = E(j,i) * Qbar(j,j); */
  /*          end */
  /*      end */
  /*      EtQbar = multiply_UtD(E, Qbar, nx, nu, N); */
  /*      % Now find Ac = EtQbar*E + Rbar */
  /*      for i = 1:nu*N */
  /*          for j = 1:nu*N */
  /*              for k = (j-1)*nx+1:nx*N */
  /*                  Ac(i,j) = Ac(i,j) + EtQbar(i,k) * E(k,j); */
  /*              end */
  /*          end */
  /*      end */
  uln_rti_linux_multiply_LtDL(uln_rti_linux_B.E,
    uln_rti_linux_ConstP.Constant21_Value, uln_rti_linux_B.Ac,
    uln_rti_linux_B.EtQbar);

  /* '<S3>:1:168' */
  /*  gs = the x's in B (due to Gauss-Newton Hessian), but ignore x_N */
  /*  similarly, gu = the u's in B */
  /* '<S3>:1:172' */
  /* '<S3>:1:173' */
  /*  in fb step, do Bc_1 + Bc_2*delx0 */
  for (i_0 = 0; i_0 < 900; i_0++) {
    uln_rti_linux_B.Ac[i_0] += uln_rti_linux_ConstP.Constant22_Value[i_0];
  }

  for (i_0 = 0; i_0 < 30; i_0++) {
    EtQbar_2 = 0.0;
    for (i_2 = 0; i_2 < 154; i_2++) {
      EtQbar_2 += uln_rti_linux_ConstP.Constant20_Value[30 * i_2 + i_0] *
        uln_rti_linux_DW.z_store_DSTATE[i_2];
    }

    rtb_gl[i_0] = 1.0E-6 - EtQbar_2;
  }

  for (i_0 = 0; i_0 < 30; i_0++) {
    EtQbar_2 = 0.0;
    for (i_2 = 0; i_2 < 154; i_2++) {
      EtQbar_2 += uln_rti_linux_ConstP.Constant20_Value[30 * i_2 + i_0] *
        uln_rti_linux_DW.z_store_DSTATE[i_2];
    }

    rtb_gu[i_0] = 0.022026431718061675 - EtQbar_2;
  }

  /* MATLAB Function: '<Root>/RTI_feedback' incorporates:
   *  Constant: '<Root>/Constant4'
   *  Inport: '<Root>/x0'
   *  MATLAB Function: '<Root>/RTI_prepare'
   *  UnitDelay: '<Root>/z_store'
   */
  /* MATLAB Function 'RTI_feedback': '<S2>:1' */
  /* rti_feedback The feedback step of a real-time iterations NMPC algorithm */
  /*  */
  /*  Jon Sowman 2016 */
  /*  j.sowman@soton.ac.uk */
  /*  */
  /*  All rights reserved */
  /*  Bounds on states */
  /* '<S2>:1:11' */
  rtb_deltax0[0] = uln_rti_linux_U.x0[0] - uln_rti_linux_DW.z_store_DSTATE[0];
  rtb_deltax0[1] = uln_rti_linux_U.x0[1] - uln_rti_linux_DW.z_store_DSTATE[1];
  rtb_deltax0[2] = uln_rti_linux_U.x0[2] - uln_rti_linux_DW.z_store_DSTATE[2];
  rtb_deltax0[3] = uln_rti_linux_U.x0[3] - uln_rti_linux_DW.z_store_DSTATE[3];

  /* '<S2>:1:12' */
  /* '<S2>:1:13' */
  /* '<S2>:1:14' */
  for (i_0 = 0; i_0 < 120; i_0++) {
    rtb_guA[i_0] = (((rtb_C[i_0 + 120] * rtb_deltax0[1] + rtb_C[i_0] *
                      rtb_deltax0[0]) + rtb_C[i_0 + 240] * rtb_deltax0[2]) +
                    rtb_C[i_0 + 360] * rtb_deltax0[3]) + (rtb_w2[i_0] +
      rtb_d[i_0]);
    rtb_glA[i_0] = -1.0E+20 - rtb_guA[i_0];
    rtb_guA[i_0] = uln_rti_linux_ConstP.Constant4_Value[i_0] - rtb_guA[i_0];
  }

  /* MATLAB Function: '<Root>/RTI_prepare' incorporates:
   *  Constant: '<Root>/Constant13'
   *  Constant: '<Root>/Constant20'
   *  MATLAB Function: '<Root>/RTI_feedback'
   */
  /*  gs = the x's in B (due to Gauss-Newton Hessian), but ignore x_N */
  /*  similarly, gu = the u's in B */
  /* '<S2>:1:18' */
  for (i_0 = 0; i_0 < 30; i_0++) {
    for (i_2 = 0; i_2 < 154; i_2++) {
      uln_rti_linux_B.dv0[i_0 + 30 * i_2] = 0.0;
      for (i_1 = 0; i_1 < 120; i_1++) {
        uln_rti_linux_B.dv0[i_0 + 30 * i_2] += uln_rti_linux_B.E[120 * i_0 + i_1]
          * uln_rti_linux_ConstP.Constant13_Value[124 * i_2 + i_1];
      }
    }
  }

  for (i_0 = 0; i_0 < 30; i_0++) {
    EtQbar[i_0] = 0.0;
    for (i_2 = 0; i_2 < 120; i_2++) {
      EtQbar[i_0] += uln_rti_linux_B.EtQbar[30 * i_2 + i_0] * rtb_d[i_2];
    }

    tmp_1[i_0] = 0.0;
    for (i_2 = 0; i_2 < 154; i_2++) {
      tmp_1[i_0] += uln_rti_linux_B.dv0[30 * i_2 + i_0] * B[i_2];
    }
  }

  for (i_0 = 0; i_0 < 30; i_0++) {
    for (i_2 = 0; i_2 < 4; i_2++) {
      EtQbar_0[i_0 + 30 * i_2] = 0.0;
      for (i_1 = 0; i_1 < 120; i_1++) {
        EtQbar_0[i_0 + 30 * i_2] += uln_rti_linux_B.EtQbar[30 * i_1 + i_0] *
          rtb_C[120 * i_2 + i_1];
      }
    }
  }

  for (i_0 = 0; i_0 < 30; i_0++) {
    EtQbar_2 = 0.0;
    for (i_2 = 0; i_2 < 154; i_2++) {
      EtQbar_2 += uln_rti_linux_ConstP.Constant20_Value[30 * i_2 + i_0] * B[i_2];
    }

    EtQbar_1[i_0] = (EtQbar[i_0] + tmp_1[i_0]) + EtQbar_2;
  }

  /* MATLAB Function: '<Root>/RTI_feedback' */
  for (i_0 = 0; i_0 < 30; i_0++) {
    EtQbar_2 = EtQbar_0[i_0 + 90] * rtb_deltax0[3] + (EtQbar_0[i_0 + 60] *
      rtb_deltax0[2] + (EtQbar_0[i_0 + 30] * rtb_deltax0[1] + EtQbar_0[i_0] *
                        rtb_deltax0[0]));
    rtb_Bc[i_0] = EtQbar_1[i_0] + EtQbar_2;
  }

  /*  qpOASES_sequence('i', prep.Ac, Bc, prep.E, prep.gl, prep.gu, glA, guA, opts); */

  /* S-Function (rqp_wrapper): '<Root>/RQP_wrp' */
  rqp_run( (real_T*)&uln_rti_linux_B.Ac[0], (real_T*)&rtb_Bc[0], (real_T*)
          &uln_rti_linux_B.E[0], (real_T*)&rtb_gl[0], (real_T*)&rtb_gu[0],
          (real_T*)&rtb_glA[0], (real_T*)&rtb_guA[0], (int16_T)
          uln_rti_linux_ConstB.DataTypeConversion, (int16_T)
          uln_rti_linux_ConstB.DataTypeConversion1, &rtb_RQP_wrp_o1[0],
          &rtb_RQP_wrp_o2[0], &rtb_RQP_wrp_o3);

  /* MATLAB Function: '<Root>/RTI_expand' incorporates:
   *  Constant: '<Root>/Constant7'
   *  Constant: '<Root>/Constant8'
   *  Inport: '<Root>/x0'
   *  UnitDelay: '<Root>/z_store'
   */
  /* MATLAB Function 'RTI_expand': '<S1>:1' */
  /* rti_expand The expansion step of a real-time iterations NMPC algorithm */
  /*  */
  /*  Jon Sowman 2016 */
  /*  j.sowman@soton.ac.uk */
  /*  */
  /*  All rights reserved */
  /* '<S1>:1:10' */
  memcpy(&rtb_znew[0], &uln_rti_linux_DW.z_store_DSTATE[0], 154U * sizeof(real_T));

  /*  Expansion step: w2+ = w2 + d + C*deltax0 + E*dz */
  /* '<S1>:1:13' */
  rtb_znew[0] = uln_rti_linux_U.x0[0];
  rtb_znew[1] = uln_rti_linux_U.x0[1];
  rtb_znew[2] = uln_rti_linux_U.x0[2];
  rtb_znew[3] = uln_rti_linux_U.x0[3];

  /* '<S1>:1:14' */
  for (i_0 = 0; i_0 < 30; i_0++) {
    EtQbar[i_0] = rtb_znew[uln_rti_linux_ConstP.Constant7_Value[i_0] - 1] +
      rtb_RQP_wrp_o1[i_0];
  }

  for (i_0 = 0; i_0 < 30; i_0++) {
    rtb_znew[uln_rti_linux_ConstP.Constant7_Value[i_0] - 1] = EtQbar[i_0];
  }

  /* '<S1>:1:15' */
  for (i_0 = 0; i_0 < 120; i_0++) {
    EtQbar_0[i_0] = (((rtb_C[i_0 + 120] * rtb_deltax0[1] + rtb_C[i_0] *
                       rtb_deltax0[0]) + rtb_C[i_0 + 240] * rtb_deltax0[2]) +
                     rtb_C[i_0 + 360] * rtb_deltax0[3]) + (rtb_w2[i_0] +
      rtb_d[i_0]);
    tmp_2[i_0] = 0.0;
    for (i_2 = 0; i_2 < 30; i_2++) {
      tmp_2[i_0] += uln_rti_linux_B.E[120 * i_2 + i_0] * rtb_RQP_wrp_o1[i_2];
    }
  }

  for (i_0 = 0; i_0 < 120; i_0++) {
    rtb_znew[uln_rti_linux_ConstP.Constant8_Value[i_0] - 1] = EtQbar_0[i_0] +
      tmp_2[i_0];
  }

  /* Outport: '<Root>/uOpt' incorporates:
   *  Constant: '<Root>/Constant7'
   *  MATLAB Function: '<Root>/RTI_expand'
   */
  /*  Output the optimal controls */
  /* '<S1>:1:18' */
  /*  RTI step complete */
  for (i = 0; i < 30; i++) {
    uln_rti_linux_Y.uOpt[i] = rtb_znew[uln_rti_linux_ConstP.Constant7_Value[i] -
      1];
  }

  /* End of Outport: '<Root>/uOpt' */

  /* Update for UnitDelay: '<Root>/z_store' */
  memcpy(&uln_rti_linux_DW.z_store_DSTATE[0], &rtb_znew[0], 154U * sizeof(real_T));
}

/* Model initialize function */
void uln_rti_linux_initialize(void)
{
  /* S-Function (rqp_wrapper): <Root>/RQP_wrp */
  rqp_start();

  /* InitializeConditions for UnitDelay: '<Root>/z_store' */
  memcpy(&uln_rti_linux_DW.z_store_DSTATE[0],
         &uln_rti_linux_ConstP.z_store_InitialCond[0], 154U * sizeof(real_T));
}

/* Model terminate function */
void uln_rti_linux_terminate(void)
{
  /* (no terminate code required) */
}

/*
 * File trailer for generated code.
 *
 * [EOF]
 */
